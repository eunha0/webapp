# 액세스 코드 유효성 검증 오류 해결 방법

## 문제 원인
로컬 데이터베이스에 액세스 코드가 존재하지 않아 학생 답안 제출 시 "유효하지 않은 액세스 코드입니다" 오류가 발생합니다.

## 즉시 해결 방법 (웹 UI 사용)

### 1단계: 교사 계정으로 로그인
1. 브라우저에서 접속: `https://3000-iigjpsbl85aj2ml3n1x69-cbeee0f9.sandbox.novita.ai/login`
2. 교사 계정으로 로그인:
   - 이메일: `teacher@test.com`
   - 비밀번호: `test1234`

### 2단계: 과제 생성 또는 확인
1. 로그인 후 "나의 페이지" 클릭
2. 기존 과제가 있다면 선택, 없다면 "새 과제 만들기" 클릭
3. 과제 정보 입력:
   - 과제 제목: 테스트 과제
   - 과제 설명: 액세스 코드 테스트용
   - 프롬프트: 자유 주제
   - 평가 기준: 기본 설정
4. "과제 생성" 버튼 클릭

### 3단계: 액세스 코드 생성
1. 생성된 과제 카드를 클릭하여 상세 정보 모달 열기
2. **"액세스 코드 생성" 버튼 클릭** ⭐ 가장 중요!
3. 6자리 숫자 액세스 코드가 생성됨 (예: 123456)
4. 액세스 코드를 메모장에 복사

### 4단계: 학생 계정으로 테스트
1. 새 탭에서 학생 로그인 페이지 접속: `https://3000-iigjpsbl85aj2ml3n1x69-cbeee0f9.sandbox.novita.ai/student/login`
2. 학생 계정으로 로그인:
   - 이메일: `student@test.com`
   - 비밀번호: `test1234`
3. 학생 대시보드에서 "과제 액세스 코드 입력" 섹션 찾기
4. 3단계에서 복사한 액세스 코드 입력 (예: 123456)
5. "코드 확인" 버튼 클릭
6. 과제 정보가 표시되면 성공!

### 5단계: 답안 제출 테스트
1. "답안 작성" 섹션에 테스트 답안 입력:
   ```
   이것은 테스트 답안입니다.
   액세스 코드가 정상적으로 작동하는지 확인하고 있습니다.
   ```
2. "답안 제출하기" 버튼 클릭
3. "답안이 제출되었습니다!" 메시지 확인
4. 제출 완료!

## 확인 사항
- ✅ 교사가 반드시 "액세스 코드 생성" 버튼을 클릭해야 함
- ✅ 액세스 코드는 6자리 숫자 (예: 123456, 789012)
- ✅ 학생은 정확한 6자리 코드를 입력해야 함
- ✅ 로그인 상태 유지 확인 (세션 만료 시 재로그인)

## 개발자 디버깅 (선택사항)

### PM2 로그 확인
```bash
cd /home/user/webapp-ai
pm2 logs webapp --nostream | tail -20
```

### 성공 로그 예시
```
[DEBUG] Student submit - access_code: 123456, student_id: 1
Code exists check: { access_code: '123456', assignment_id: 1 }
POST /api/student/submit 200 OK
```

### 실패 로그 예시 (코드 없음)
```
[DEBUG] Student submit - access_code: 999999, student_id: 1
Code exists check: null
POST /api/student/submit 404 Not Found
```

## 주의사항
⚠️ **로컬 개발 환경의 한계:**
- 로컬 데이터베이스(`.wrangler/state/v3/d1/`)는 서비스 재시작 시 초기화될 수 있습니다
- 프로덕션 배포 시에는 Cloudflare D1 프로덕션 데이터베이스를 사용하므로 이 문제가 발생하지 않습니다
- 개발 중에는 테스트 계정과 액세스 코드를 재생성해야 할 수 있습니다

## 다음 단계
1. ✅ 위 단계를 따라 액세스 코드 생성 및 테스트
2. ✅ 정상 작동 확인
3. 🚀 프로덕션 배포 준비 (Cloudflare Pages)

---
**현재 서비스 URL:** https://3000-iigjpsbl85aj2ml3n1x69-cbeee0f9.sandbox.novita.ai
**서비스 상태:** ✅ Online (PM2 관리)
